

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Read-Write set semantics - 读写集语义 &mdash; hyperledger-fabricdocs master documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Gossip data dissemination protocol" href="gossip.html" />
    <link rel="prev" title="Peer channel-based event services" href="peer_event_services.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          


          
            <a href="index.html" class="icon icon-home"> hyperledger-fabricdocs
          

          
          </a>

          
            
            
              <div class="version">
                master
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
<br>
<a href="https://chat.hyperledger.org">Rocket Chat</a>  <a href="https://jenkins.hyperledger.org/">CI</a>
<a href="http://stackoverflow.com/questions/tagged/hyperledger-fabric">StackOverflow</a>
<br>
<a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
  <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a>
  <br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.

        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">目录</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">欢迎来到 Hyperledger Fabric</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="getting_started.html">入门指南</a></li>
<li class="toctree-l2"><a class="reference internal" href="key_concepts.html">Key Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials.html">Tutorials - 教程</a></li>
<li class="toctree-l2"><a class="reference internal" href="ops_guide.html">Operations Guides</a></li>
<li class="toctree-l2"><a class="reference internal" href="command_ref.html">Commands Reference</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="architecture.html">架构参考</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="arch-deep-dive.html">架构解读</a></li>
<li class="toctree-l3"><a class="reference internal" href="txflow.html">Transaction Flow</a></li>
<li class="toctree-l3"><a class="reference internal" href="txflow.html#id1">交易流程</a></li>
<li class="toctree-l3"><a class="reference external" href="http://hyperledger-fabric-ca.readthedocs.io/en/latest">Hyperledger Fabric CA用户手册</a></li>
<li class="toctree-l3"><a class="reference internal" href="fabric-sdks.html">Hyperledger Fabric SDKs</a></li>
<li class="toctree-l3"><a class="reference internal" href="fabric-sdks.html#sdks">超级账本 SDKs</a></li>
<li class="toctree-l3"><a class="reference internal" href="channels.html">通道</a></li>
<li class="toctree-l3"><a class="reference internal" href="capability_requirements.html">功能需求</a></li>
<li class="toctree-l3"><a class="reference internal" href="couchdb_as_state_database.html">使用CouchDB作为状态数据库</a></li>
<li class="toctree-l3"><a class="reference internal" href="peer_event_services.html">节点基于通道的事件服务</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">读写集</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#transaction-simulation-and-read-write-set">Transaction simulation and read-write set - 交易模拟和读写集</a></li>
<li class="toctree-l4"><a class="reference internal" href="#transaction-validation-and-updating-world-state-using-read-write-set">Transaction validation and updating world state using read-write set - 交易验证以及使用读写集更新世界状态</a></li>
<li class="toctree-l4"><a class="reference internal" href="#example-simulation-and-validation">Example simulation and validation - 模拟和验证示例</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="gossip.html">Gossip数据传输协议</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Fabric-FAQ.html">Hyperledger Fabric FAQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="ordering-service-faq.html">Ordering Service FAQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="CONTRIBUTING.html">Contributions Welcome!</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html">Glossary - 词汇表</a></li>
<li class="toctree-l2"><a class="reference internal" href="releases.html">Release Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="questions.html">Still Have Questions? - 依然遇到问题？</a></li>
<li class="toctree-l2"><a class="reference internal" href="status.html">Status - 状态</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">入门指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="key_concepts.html">Key Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials - 教程</a></li>
<li class="toctree-l1"><a class="reference internal" href="ops_guide.html">Operations Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="command_ref.html">Commands Reference</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="architecture.html">架构参考</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="arch-deep-dive.html">架构解读</a></li>
<li class="toctree-l2"><a class="reference internal" href="txflow.html">Transaction Flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="txflow.html#id1">交易流程</a></li>
<li class="toctree-l2"><a class="reference external" href="http://hyperledger-fabric-ca.readthedocs.io/en/latest">Hyperledger Fabric CA用户手册</a></li>
<li class="toctree-l2"><a class="reference internal" href="fabric-sdks.html">Hyperledger Fabric SDKs</a></li>
<li class="toctree-l2"><a class="reference internal" href="fabric-sdks.html#sdks">超级账本 SDKs</a></li>
<li class="toctree-l2"><a class="reference internal" href="channels.html">通道</a></li>
<li class="toctree-l2"><a class="reference internal" href="capability_requirements.html">功能需求</a></li>
<li class="toctree-l2"><a class="reference internal" href="couchdb_as_state_database.html">使用CouchDB作为状态数据库</a></li>
<li class="toctree-l2"><a class="reference internal" href="peer_event_services.html">节点基于通道的事件服务</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">读写集</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#transaction-simulation-and-read-write-set">Transaction simulation and read-write set - 交易模拟和读写集</a></li>
<li class="toctree-l3"><a class="reference internal" href="#transaction-validation-and-updating-world-state-using-read-write-set">Transaction validation and updating world state using read-write set - 交易验证以及使用读写集更新世界状态</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-simulation-and-validation">Example simulation and validation - 模拟和验证示例</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="gossip.html">Gossip数据传输协议</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Fabric-FAQ.html">Hyperledger Fabric FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="ordering-service-faq.html">Ordering Service FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="CONTRIBUTING.html">Contributions Welcome!</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary - 词汇表</a></li>
<li class="toctree-l1"><a class="reference internal" href="releases.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="questions.html">Still Have Questions? - 依然遇到问题？</a></li>
<li class="toctree-l1"><a class="reference internal" href="status.html">Status - 状态</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">hyperledger-fabricdocs</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="architecture.html">架构参考</a> &raquo;</li>
        
      <li>Read-Write set semantics - 读写集语义</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/readwrite.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="read-write-set-semantics">
<h1>Read-Write set semantics - 读写集语义<a class="headerlink" href="#read-write-set-semantics" title="Permalink to this headline">¶</a></h1>
<p>This documents discusses the details of the current implementation about
the semantics of read-write sets.</p>
<p>本文档讨论了当前代码实现中读写集语义的具体细节。</p>
<div class="section" id="transaction-simulation-and-read-write-set">
<h2>Transaction simulation and read-write set - 交易模拟和读写集<a class="headerlink" href="#transaction-simulation-and-read-write-set" title="Permalink to this headline">¶</a></h2>
<p>During simulation of a transaction at an <code class="docutils literal notranslate"><span class="pre">endorser</span></code>, a read-write set
is prepared for the transaction. The <code class="docutils literal notranslate"><span class="pre">read</span> <span class="pre">set</span></code> contains a list of
unique keys and their committed versions that the transaction reads
during simulation. The <code class="docutils literal notranslate"><span class="pre">write</span> <span class="pre">set</span></code> contains a list of unique keys
(though there can be overlap with the keys present in the read set) and
their new values that the transaction writes. A delete marker is set (in
the place of new value) for the key if the update performed by the
transaction is to delete the key.</p>
<p>在 <code class="docutils literal notranslate"><span class="pre">背书节点</span></code> 模拟执行交易期间，会生成该交易对应的一个读写集。<code class="docutils literal notranslate"><span class="pre">读集合(read</span> <span class="pre">set)</span></code> 包含了在模拟执行交易期间，所读取的一组不重复的 key 及其版本号的列表。<code class="docutils literal notranslate"><span class="pre">写集合（write</span> <span class="pre">set）</span></code> 包含了一组不重复的 key（这些 key 可能和读集合中的 key 有重合）以及该交易写入的这些 key 对应的值。如果交易对应的更新操作是删除某个 key，则该 key 对应的值会被设置删除标记。</p>
<p>Further, if the transaction writes a value multiple times for a key,
only the last written value is retained. Also, if a transaction reads a
value for a key, the value in the committed state is returned even if
the transaction has updated the value for the key before issuing the
read. In another words, Read-your-writes semantics are not supported.</p>
<p>进一步的，如果交易对一个 key 对应的值进行多次写入，只有最后一次的修改会被保留。同样，如果交易读取一个 key 对应的 值，只有之前已经提交的值会被返回，即使在读操作前本交易已经对该 key 的值进行了修改。换而言之，不支持读取同一交易中刚修改的值。</p>
<p>As noted earlier, the versions of the keys are recorded only in the read
set; the write set just contains the list of unique keys and their
latest values set by the transaction.</p>
<p>如前所述，key 对应的版本号只在读集合中被记录；写集合中只包含一组不重复的 key 及其在交易中设置的的最新值。</p>
<p>There could be various schemes for implementing versions. The minimal
requirement for a versioning scheme is to produce non-repeating
identifiers for a given key. For instance, using monotonically
increasing numbers for versions can be one such scheme. In the current
implementation, we use a blockchain height based versioning scheme in
which the height of the committing transaction is used as the latest
version for all the keys modified by the transaction. In this scheme,
the height of a transaction is represented by a tuple (txNumber is the
height of the transaction within the block). This scheme has many
advantages over the incremental number scheme - primarily, it enables
other components such as statedb, transaction simulation and validation
for making efficient design choices.</p>
<p>有多种方案可以用于实现读集合的版本控制。版本控制方案的最基本要求是为 key 生成一个不会重复的标识符。例如，可以使用单调递增的数字来作为版本号。在目前的代码实现中，我们采用了一个基于区块链高度的版本号方案，在该方案中，待提交交易的高度作为该交易对应写集合的所有 key 的最新版本号。交易高度可以用一个元组表示，其中 txNumber 是交易在区块中的高度。该方案相较于递增数字方案有诸多优点，它使得其他组件（例如状态数据库、交易模拟以及验证等）可以选择更高效的设计方案。</p>
<p>Following is an illustration of an example read-write set prepared by
simulation of a hypothetical transaction. For the sake of simplicity, in
the illustrations, we use the incremental numbers for representing the
versions.</p>
<p>如下是一个读写集的示例说明，该读写集通过模拟一个假设交易而生成。为了简单起见，在该示例中我们使用递增数字来表示版本号。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">TxReadWriteSet</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">NsReadWriteSet</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;chaincode1&quot;</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">read</span><span class="o">-</span><span class="nb">set</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">read</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;K1&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">read</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;K2&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="o">&gt;</span>
    <span class="o">&lt;/</span><span class="n">read</span><span class="o">-</span><span class="nb">set</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">write</span><span class="o">-</span><span class="nb">set</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">write</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;K1&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;V1&quot;</span>
      <span class="o">&lt;</span><span class="n">write</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;K3&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;V2&quot;</span>
      <span class="o">&lt;</span><span class="n">write</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;K4&quot;</span><span class="p">,</span> <span class="n">isDelete</span><span class="o">=</span><span class="s2">&quot;true&quot;</span>
    <span class="o">&lt;/</span><span class="n">write</span><span class="o">-</span><span class="nb">set</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">NsReadWriteSet</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">TxReadWriteSet</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Additionally, if the transaction performs a range query during
simulation, the range query as well as its results will be added to the
read-write set as <code class="docutils literal notranslate"><span class="pre">query-info</span></code>.</p>
<p>此外，如果在交易模拟执行中进行了一个批量查询，批量查询及其结果都会被添加到读写集的 <code class="docutils literal notranslate"><span class="pre">query-info</span></code> 中</p>
</div>
<div class="section" id="transaction-validation-and-updating-world-state-using-read-write-set">
<h2>Transaction validation and updating world state using read-write set - 交易验证以及使用读写集更新世界状态<a class="headerlink" href="#transaction-validation-and-updating-world-state-using-read-write-set" title="Permalink to this headline">¶</a></h2>
<p>A <code class="docutils literal notranslate"><span class="pre">committer</span></code> uses the read set portion of the read-write set for
checking the validity of a transaction and the write set portion of the
read-write set for updating the versions and the values of the affected
keys.</p>
<p><code class="docutils literal notranslate"><span class="pre">提交者(committer)</span></code> 使用读写集中的读集合来验证交易的合法性，使用读写集中的写集合来更新对应 key 的值和版本号。</p>
<p>In the validation phase, a transaction is considered <code class="docutils literal notranslate"><span class="pre">valid</span></code> if the
version of each key present in the read set of the transaction matches
the version for the same key in the world state - assuming all the
preceding <code class="docutils literal notranslate"><span class="pre">valid</span></code> transactions (including the preceding transactions
in the same block) are committed (<em>committed-state</em>). An additional
validation is performed if the read-write set also contains one or more
query-info.</p>
<p>在验证阶段，交易被认为 <code class="docutils literal notranslate"><span class="pre">有效(valid)</span></code> 的条件是该交易读集合中的每一个 key 对应的版本号同最新世界状态中该 key 对应的版本号全都一致，这个最新世界状态是之前所有 <code class="docutils literal notranslate"><span class="pre">有效</span></code> 交易（包括同一区块中排在前面的交易）提交之后的状态。如果读写集包含一个或者多个 query-info，则需要进行一个额外的验证。</p>
<p>This additional validation should ensure that no key has been
inserted/deleted/updated in the super range (i.e., union of the ranges)
of the results captured in the query-info(s). In other words, if we
re-execute any of the range queries (that the transaction performed
during simulation) during validation on the committed-state, it should
yield the same results that were observed by the transaction at the time
of simulation. This check ensures that if a transaction observes phantom
items during commit, the transaction should be marked as invalid. Note
that the this phantom protection is limited to range queries (i.e.,
<code class="docutils literal notranslate"><span class="pre">GetStateByRange</span></code> function in the chaincode) and not yet implemented
for other queries (i.e., <code class="docutils literal notranslate"><span class="pre">GetQueryResult</span></code> function in the chaincode).
Other queries are at risk of phantoms, and should therefore only be used
in read-only transactions that are not submitted to ordering, unless the
application can guarantee the stability of the result set between
simulation and validation/commit time.</p>
<p>该额外验证需要确保在一定范围之内（例如多个范围的联合）没有 key 被插入、删除或更新。换句话说，如果我们在验证阶段重新执行批量查询（正如在交易模拟执行阶段一样），得到的查询结果应该和在交易模拟执行阶段完全一致。此校验确保交易在提交时如果出现幻读会被认为是无效的。值得注意的是，这种针对幻读的保护只被用于部分批量查询（例如链码中的 <code class="docutils literal notranslate"><span class="pre">GetStateByRange</span></code> 函数），并没有被用于其他的批量查询（例如链码中的 <code class="docutils literal notranslate"><span class="pre">GetQueryResult</span></code> 函数）。没有保护的批量查询方法会有幻读风险，因此这种查询应该只用于不会被提交到排序服务的 <code class="docutils literal notranslate"><span class="pre">只读交易</span></code>，除非应用方能保证交易模拟和交易验证提交两阶段之间结果集是稳定不变的。</p>
<p>If a transaction passes the validity check, the committer uses the write
set for updating the world state. In the update phase, for each key
present in the write set, the value in the world state for the same key
is set to the value as specified in the write set. Further, the version
of the key in the world state is changed to reflect the latest version.</p>
<p>如果一个交易通过了有效性检查，提交者使用写集合更新世界状态。在更新阶段，对于写集合中的每一个 key，世界状态中该 key 对应的值都被设置为写集合中的值。进一步的，世界状态中该 key 对应的版本号也会被修改为最新的版本号。</p>
</div>
<div class="section" id="example-simulation-and-validation">
<h2>Example simulation and validation - 模拟和验证示例<a class="headerlink" href="#example-simulation-and-validation" title="Permalink to this headline">¶</a></h2>
<p>This section helps with understanding the semantics through an example
scenario. For the purpose of this example, the presence of a key, <code class="docutils literal notranslate"><span class="pre">k</span></code>,
in the world state is represented by a tuple <code class="docutils literal notranslate"><span class="pre">(k,ver,val)</span></code> where
<code class="docutils literal notranslate"><span class="pre">ver</span></code> is the latest version of the key <code class="docutils literal notranslate"><span class="pre">k</span></code> having <code class="docutils literal notranslate"><span class="pre">val</span></code> as its
value.</p>
<p>本节通过一个具体的实例来帮助理解读写集语义。为了理解实例方便，世界状态中 key <code class="docutils literal notranslate"><span class="pre">k</span></code> 使用如下元组来表示 <code class="docutils literal notranslate"><span class="pre">(k,ver,val)</span></code>，其中 <code class="docutils literal notranslate"><span class="pre">ver</span></code> 表示该 key <code class="docutils literal notranslate"><span class="pre">k</span></code> 对应的最新版本号，<code class="docutils literal notranslate"><span class="pre">val</span></code> 表示其对应的值。</p>
<p>Now, consider a set of five transactions <code class="docutils literal notranslate"><span class="pre">T1,</span> <span class="pre">T2,</span> <span class="pre">T3,</span> <span class="pre">T4,</span> <span class="pre">and</span> <span class="pre">T5</span></code>, all
simulated on the same snapshot of the world state. The following snippet
shows the snapshot of the world state against which the transactions are
simulated and the sequence of read and write activities performed by
each of these transactions.</p>
<p>现在，考虑 5 个交易的集合 <code class="docutils literal notranslate"><span class="pre">T1,</span> <span class="pre">T2,</span> <span class="pre">T3,</span> <span class="pre">T4</span> <span class="pre">和</span> <span class="pre">T5</span></code>，每个交易都是基于相同的世界状态快照进行模拟执行。如下代码展示了交易模拟执行对应的世界状态，以及每个交易中所包含的读写动作。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">World</span> <span class="n">state</span><span class="p">:</span> <span class="p">(</span><span class="n">k1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">v1</span><span class="p">),</span> <span class="p">(</span><span class="n">k2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">v2</span><span class="p">),</span> <span class="p">(</span><span class="n">k3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">v3</span><span class="p">),</span> <span class="p">(</span><span class="n">k4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">v4</span><span class="p">),</span> <span class="p">(</span><span class="n">k5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">v5</span><span class="p">)</span>
<span class="n">T1</span> <span class="o">-&gt;</span> <span class="n">Write</span><span class="p">(</span><span class="n">k1</span><span class="p">,</span> <span class="n">v1</span><span class="s1">&#39;), Write(k2, v2&#39;</span><span class="p">)</span>
<span class="n">T2</span> <span class="o">-&gt;</span> <span class="n">Read</span><span class="p">(</span><span class="n">k1</span><span class="p">),</span> <span class="n">Write</span><span class="p">(</span><span class="n">k3</span><span class="p">,</span> <span class="n">v3</span><span class="s1">&#39;)</span>
<span class="n">T3</span> <span class="o">-&gt;</span> <span class="n">Write</span><span class="p">(</span><span class="n">k2</span><span class="p">,</span> <span class="n">v2</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">T4</span> <span class="o">-&gt;</span> <span class="n">Write</span><span class="p">(</span><span class="n">k2</span><span class="p">,</span> <span class="n">v2</span><span class="s1">&#39;&#39;&#39;), read(k2)</span>
<span class="s1">T5 -&gt; Write(k6, v6&#39;), read(k5)</span>
</pre></div>
</div>
<p>Now, assume that these transactions are ordered in the sequence of
T1,..,T5 (could be contained in a single block or different blocks)</p>
<p>现在，假设这些交易的排序如下 T1,…,T5（可能包含在同一区块或多个区块中）</p>
<ol class="arabic simple">
<li><code class="docutils literal notranslate"><span class="pre">T1</span></code> passes validation because it does not perform any read.
Further, the tuple of keys <code class="docutils literal notranslate"><span class="pre">k1</span></code> and <code class="docutils literal notranslate"><span class="pre">k2</span></code> in the world state are
updated to <code class="docutils literal notranslate"><span class="pre">(k1,2,v1'),</span> <span class="pre">(k2,2,v2')</span></code></li>
</ol>
<ol class="arabic simple">
<li><code class="docutils literal notranslate"><span class="pre">T1</span></code> 通过验证，因为它没有任何的读操作。
随后，世界状态中 <code class="docutils literal notranslate"><span class="pre">k1</span></code> 和 <code class="docutils literal notranslate"><span class="pre">k2</span></code> 对应的元组被更新为 <code class="docutils literal notranslate"><span class="pre">(k1,2,v1'),</span> <span class="pre">(k2,2,v2')</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">T2</span></code> fails validation because it reads a key, <code class="docutils literal notranslate"><span class="pre">k1</span></code>, which was
modified by a preceding transaction - <code class="docutils literal notranslate"><span class="pre">T1</span></code></li>
</ol>
<ol class="arabic simple" start="2">
<li><code class="docutils literal notranslate"><span class="pre">T2</span></code> 验证失败，因为它读取了 key <code class="docutils literal notranslate"><span class="pre">k1</span></code>，而 <code class="docutils literal notranslate"><span class="pre">k1</span></code> 在之前的 <code class="docutils literal notranslate"><span class="pre">T1</span></code> 交易中被修改</li>
<li><code class="docutils literal notranslate"><span class="pre">T3</span></code> passes the validation because it does not perform a read.
Further the tuple of the key, <code class="docutils literal notranslate"><span class="pre">k2</span></code>, in the world state is updated
to <code class="docutils literal notranslate"><span class="pre">(k2,3,v2'')</span></code></li>
</ol>
<ol class="arabic simple" start="3">
<li><code class="docutils literal notranslate"><span class="pre">T3</span></code> 通过验证，因为它没有任何的读操作。
随后，世界状态中 <code class="docutils literal notranslate"><span class="pre">k2</span></code> 对应的元组被更新为 <code class="docutils literal notranslate"><span class="pre">(k2,3,v2'')</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">T4</span></code> fails the validation because it reads a key, <code class="docutils literal notranslate"><span class="pre">k2</span></code>, which was
modified by a preceding transaction <code class="docutils literal notranslate"><span class="pre">T1</span></code></li>
</ol>
<ol class="arabic simple" start="4">
<li><code class="docutils literal notranslate"><span class="pre">T4</span></code> 验证失败，因为它读取了 key <code class="docutils literal notranslate"><span class="pre">k2</span></code>，而 <code class="docutils literal notranslate"><span class="pre">k2</span></code> 在之前的 <code class="docutils literal notranslate"><span class="pre">T1</span></code> 交易中被修改</li>
<li><code class="docutils literal notranslate"><span class="pre">T5</span></code> passes validation because it reads a key, <code class="docutils literal notranslate"><span class="pre">k5,</span></code> which was
not modified by any of the preceding transactions</li>
</ol>
<ol class="arabic simple" start="5">
<li><code class="docutils literal notranslate"><span class="pre">T5</span></code> 通过验证，因为它只读取了 key <code class="docutils literal notranslate"><span class="pre">k5</span></code>，而 <code class="docutils literal notranslate"><span class="pre">k5</span></code> 在之前的所有交易中都并未被修改</li>
</ol>
<p><strong>Note</strong>: Transactions with multiple read-write sets are not yet supported.</p>
<p><strong>注意</strong>: 暂不支持包含多个读写集的交易。</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="gossip.html" class="btn btn-neutral float-right" title="Gossip data dissemination protocol" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="peer_event_services.html" class="btn btn-neutral" title="Peer channel-based event services" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Hyperledger 2017.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'master',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>